---
title: "Divides in Development: An Analysis on the Impact of Modern Western Colonialism on Today's Economies"
author: "Faria Khandaker"
date: "04/12/2020"
output:
  pdf_document:
    latex_engine: lualatex
  html_document:
    
    df_print: paged
font: 12pt
abstract: "The effects of Modern Western Colonialism are still visible in today's global political landscape. In my replication experiment, settler mortality is used as an instrumental variable to investigate the relationship between protection against expropriation and Gross Domestic Product per capita of former colonies. Former colonies with strong protection against expropriation tend to enjoy higher GDP per capita today. Whether or not the colonial powers established strong protections against expropriation laws can explain Colonies with high settler mortality were less Strong land ownership laws are often attributed with strong legal systems in countries which impact protection of private enterprises. land owners from corrupt government What was done, what was found and why it matters?"
---
```{r message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(dplyr)
library(janitor)
library(ggplot2)
library(haven)
library(huxtable)
library(estimatr)
```
```{r,echo=FALSE}
data4 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable4.dta")
data5 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable5.dta")
data6 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable6.dta")
```
```{r select only 63 countries that are excolonies, echo=FALSE}

excolonies <- tibble(country=data4$shortnam,
                     samples=data4$baseco,
                     dummy_africa=data4$africa,
                     dummy_asia=data4$asia,
                     dummy_neu=data4$rich4,
                     britcol=data5$f_brit,
                     frencol=data5$f_french,
                     landlocked=data6$landlock,
                     settler_mortality=data4$logem4,
                     expro_pro=data4$avexpr, 
                     gdppc=data4$logpgp95
          
                     )%>% subset(samples==1)



excolonies<-excolonies %>% mutate(counttrycol= case_when(
                                  britcol==1~"British",
                                  frencol==1~"French",
                                  britcol==0~"Other",
                                  frencol==0~"Other"))


#latin american / caribbean countries

excolonies<-
  excolonies %>%
  mutate(nonasaf= dummy_africa+dummy_asia+dummy_neu,
         nonasaf=if_else(nonasaf==0,1,0))

#only latin american and caribbean
excolnocon <- excolonies %>% subset(dummy_africa==0)%>%
  subset(dummy_asia==0)%>%
  subset(dummy_neu==0)

#excolonies is master table with everything

#excolonies2 master table without dummy_neu, to take away outliers
excolonies2<-excolonies[!(excolonies$dummy_neu==1),]


#only africa
african<-
excolonies %>%
  filter(dummy_africa == "1")

# all colonies without africa
non_african <-
excolonies %>%
  filter(dummy_africa == "0")

#only asia
asian<-excolonies %>%
  filter(dummy_asia == "1")
#all colonies without asia

non_asian<-excolonies %>%
  filter(dummy_asia == "0")
#all colonies without latin america/caribbean
nonlacar<- excolonies%>%
  filter(nonasaf=="0")

#only neo-europe
neu <- excolonies %>%
  filter(dummy_neu == "1")


```

# Introduction
In 1492, Christopher Colombus with a crew of 90 men set sail from Spain on a mission to discover a sea route that would reach the spice ladened lands of India and China. He had no way of knowing that two giant landmasses stood in the way of his ambitions. His discovery of these new lands ignited the period of history dominated by the phenomenon of Western colonialism which saw 300 years of the slave trade, the decimation of entire Native populations through war and disease, and the emergence of European super powers whose wealth was attributed to amassing large amounts of precious metals and raw resources from their colonies.

The effects of colonization are deeply embedded into today's global political landscape with many countries still coping with the aftermath of having been governed by a foreign power, often with little to no understanding of local cultures, for hundreds of years. Of course, colonization hasn't impacted all countrie equally. In the paper by Daron Acemoglu, Simon Johnson, and James A Robinson titled "The Colonial Origins of Comparative Development: An Empirical Investigation", it is hypothesized that different strategies used by colonial powers impacted how the colonies were governed. Colonies with stronger protection against expropriation 


# Discussion and Analysis

## Model

$$R_i=\zeta+\beta(log)M_i+X_i(\delta)+\upsilon_{i} $$
$$log(y_i) =\mu+\alpha R_i+X_i(\gamma) +\epsilon_i $$

```{r mortal gdp expro for all excolonies, message=FALSE, warning=FALSE, include=FALSE}
mortalgdp<- lm(gdppc~settler_mortality, data=excolonies)

mortalexpro<-lm(expro_pro~settler_mortality, data=excolonies)

coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]


```
```{r 2 stages effect of expropriation on GDP, include=FALSE}
first_stage <- lm(expro_pro~settler_mortality, data=excolonies)
Expropriation_Protection <- first_stage$fitted.values
second_stage <- lm(gdppc~Expropriation_Protection, data=excolonies)


```
```{r lm mortalgdp non_african, echo=FALSE}
mortalgdp <- lm(gdppc~settler_mortality, data=non_african)

```
```{r lm mortalexpro non_african, echo=FALSE}

mortalexpro <- lm(expro_pro~settler_mortality, data=non_african)

```
```{r non_african effect of expropriation on gdp, include=FALSE}
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage4<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage4<-lm(gdppc~Expropriation_Protection,data=non_african)


```
```{r lm mortalgdp excolonies2, include=FALSE}
mortalgdp <- lm(gdppc~settler_mortality, data=excolonies2)


mortalexpro <- lm(expro_pro~settler_mortality, data=excolonies2)

```
```{r excolonies2 effect of expropriation on gdp, message=FALSE, warning=FALSE, include=FALSE}
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]

first_stage2<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage2<-lm(gdppc~Expropriation_Protection,data=excolonies2)


```
```{r OLS regression of colonies, message=FALSE, warning=FALSE, include=FALSE}
#excolonies
exprogdp<-lm(gdppc~expro_pro, data=excolonies)

#excolonies2
exprogdp2<-lm(gdppc~expro_pro, data=excolonies2)

#non_african
exprogdpnonaf<-lm(gdppc~expro_pro, data=non_african)

```


```{r summary stats table, echo=FALSE, message=FALSE, warning=FALSE}

inclusive_first_stage<-huxreg("Excolonies"=first_stage, "Non Neu"=first_stage2, "Non_African"=first_stage4)

inclusive_second_stage<-huxreg("Excolonies"=second_stage,"Non Neu"=second_stage2,"Non_African"=second_stage4)
#,"Non-Asia"=second_stage6, "Non_Latin/Carib"=second_stage7

inclusive_ols<-huxreg("Excolonies"=exprogdp, "Non Neu"=exprogdp2, "Non_African"=exprogdpnonaf)

binded<-rbind(inclusive_second_stage,inclusive_first_stage,inclusive_ols)
caption(binded)<-"Table 1: Summary Statistics of Variables Considered"
height(binded)<-3
binded
```
Table 1 contains summary statistics of the variables used in this study and their relationships to one another.

```{r expro vs gdp, echo=FALSE}
exprogdp<-lm(gdppc~expro_pro, data=excolonies)
ggplot(data=excolonies)+
  geom_point(mapping=aes(x=expro_pro, 
                         y=gdppc, color=counttrycol))+
  geom_abline(intercept = 4.660, 
              slope=0.522, color="red")+theme(legend.position = "bottom",
        text=element_text(size=10))+labs(title="Figure 1: Expropriation Protection VS GDP",x="Protection Against Expropriation", y="GDP Per Capita",colour="Colonial Power")

```
```{r mortalgdp excolonies graph, echo=FALSE}
ggplot(data=excolonies)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+
  geom_abline(intercept = 10.731, 
              slope=-0.607, color="red")+theme(legend.position = "bottom",
        text=element_text(size=10))+labs(title="Figure 2: Relationship between settler mortality and GDP",x="Settler Mortality", y="GDP Per Capita",colour="Colonial Power")

```
```{r mortalexpro excolonies graph, echo=FALSE}
mortalgdp<-lm(expro_pro~settler_mortality,data=excolonies)
ggplot(data=excolonies)+
  geom_point(mapping=aes(x=settler_mortality,
                         y=expro_pro,colour=counttrycol))+
  geom_abline(intercept = 9.341, 
              slope=-0.607, color="red")+theme(legend.position = "bottom",
        text=element_text(size=10))+labs(title="Figure 3: Relationship between settler mortality and Expropriation Protection",x="Settler Mortality", y="Protection against Expropriation",colour="Colonial Power")

```


### short comings and limitations




# Ethics




# Conclusion
Colonialism was bad news for native populations across all colonies. The places in the world where European settlers could settle had native populations being forced to give up their lands, let go of their culture and accept a foreign one as their own, and if that wasn't enough, they were being killed in the millions by European diseases like small  The colonies where europeans couldn't safely settle because of the prescence of endemic diseases like Yellow Fever and Malaria, natives faced exploitation, the robbery of resources and the establishment of weak political and legal structures that serve as obstacles for those countries to this day.

# References

### libraries used
```{r, echo=FALSE}
citation("tidyverse")
```
  H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
  Springer-Verlag New York, 2016.
  
  Wickham et al., (2019). Welcome to the tidyverse. Journal of
  Open Source Software, 4(43), 1686,
  https://doi.org/10.21105/joss.01686



### Datasets used can be found here
http://economics.mit.edu/faculty/acemoglu/data/ajr2001

### Research sources




# Appendix




```{r Appselect only 63 countries that are excolonies}

excolonies <- tibble(country=data4$shortnam,
                     samples=data4$baseco,
                     dummy_africa=data4$africa,
                     dummy_asia=data4$asia,
                     dummy_neu=data4$rich4,
                     britcol=data5$f_brit,
                     frencol=data5$f_french,
                     landlocked=data6$landlock,
                     settler_mortality=data4$logem4,
                     expro_pro=data4$avexpr, 
                     gdppc=data4$logpgp95
          
                     )%>% subset(samples==1)



excolonies<-excolonies %>% mutate(counttrycol= case_when(
                                  britcol==1~"British",
                                  frencol==1~"French",
                                  britcol==0~"Other",
                                  frencol==0~"Other"))


#latin american / caribbean countries

excolonies<-
  excolonies %>%
  mutate(nonasaf= dummy_africa+dummy_asia+dummy_neu,
         nonasaf=if_else(nonasaf==0,1,0))

#only latin american and caribbean
excolnocon <- excolonies %>% subset(dummy_africa==0)%>%
  subset(dummy_asia==0)%>%
  subset(dummy_neu==0)

#excolonies is master table with everything

#excolonies2 master table without dummy_neu, to take away outliers
excolonies2<-excolonies[!(excolonies$dummy_neu==1),]


#only africa
african<-
excolonies %>%
  filter(dummy_africa == "1")

# all colonies without africa
non_african <-
excolonies %>%
  filter(dummy_africa == "0")

#only asia
asian<-excolonies %>%
  filter(dummy_asia == "1")
#all colonies without asia

non_asian<-excolonies %>%
  filter(dummy_asia == "0")
#all colonies without latin america/caribbean
nonlacar<- excolonies%>%
  filter(nonasaf=="0")

#only neo-europe
neu <- excolonies %>%
  filter(dummy_neu == "1")


```

```{r lm mortalgdp only africa}
mortalgdp <- lm(gdppc~settler_mortality, data=african)
summary(mortalgdp)
```
```{r lm mortalexpro only africa}

mortalexpro <- lm(expro_pro~settler_mortality, data=african)
summary(mortalexpro)
```

```{r only africa effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
#your gdp will increase by 2 points if you have strong expropriation laws

first_stage3<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage3<-lm(gdppc~Expropriation_Protection,data=african)
summary(second_stage3)
```
```{r Applm mortalgdp non_african}
mortalgdp <- lm(gdppc~settler_mortality, data=non_african)
summary(mortalgdp)
```
```{r Applm mortalexpro non_african}

mortalexpro <- lm(expro_pro~settler_mortality, data=non_african)
summary(mortalexpro)

```
```{r Appnon_african effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage4<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage4<-lm(gdppc~Expropriation_Protection,data=non_african)
summary(second_stage4)

```

```{r lm mortalgdp asian}
mortalgdp <- lm(gdppc~settler_mortality, data=asian)
summary(mortalgdp)
```
```{r lm mortalexpro asian}

mortalexpro <- lm(expro_pro~settler_mortality, data=asian)
summary(mortalexpro)

```
```{r asian effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage5<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage5<-lm(gdppc~Expropriation_Protection,data=asian)
summary(second_stage5)

```

```{r lm mortalgdp non_asian}
mortalgdp <- lm(gdppc~settler_mortality, data=non_asian)
summary(mortalgdp)
```
```{r lm mortalexpro non_asian}

mortalexpro <- lm(expro_pro~settler_mortality, data=non_asian)
summary(mortalexpro)

```
```{r non_asian effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage6<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage6<-lm(gdppc~Expropriation_Protection,data=non_asian)
summary(second_stage6)

```



```{r lm mortalgdp nonlacar}
mortalgdp <- lm(gdppc~settler_mortality, data=nonlacar)
summary(mortalgdp)
```
```{r lm mortalexpro nonlacar}

mortalexpro <- lm(expro_pro~settler_mortality, data=nonlacar)
summary(mortalexpro)

```
```{r nonlacar effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage7<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage7<-lm(gdppc~Expropriation_Protection,data=nonlacar)
summary(second_stage7)

```

```{r lm mortalgdp neu}
mortalgdp <- lm(gdppc~settler_mortality, data=neu)
summary(mortalgdp)
```
```{r lm mortalexpro neu}

mortalexpro <- lm(expro_pro~settler_mortality, data=neu)
summary(mortalexpro)

```
```{r neu effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage8<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage8<-lm(gdppc~Expropriation_Protection,data=neu)
summary(second_stage8)

```


```{r histogram for gdp and expropriation non neu}
ggplot(data=excolonies2,mapping=aes(x=expro_pro, fill=counttrycol))+
  geom_histogram(position="dodge",binwidth=0.4)+theme_minimal()+scale_fill_brewer(palette = "Set1")
#facet_wrap(vars(dummy_asia), nrow=2)

```
### Excolonies2 is includes all excolonies except the neo european first world countries
```{r Applm mortalgdp excolonies2}
mortalgdp <- lm(gdppc~settler_mortality, data=excolonies2)
summary(mortalgdp)

mortalexpro <- lm(expro_pro~settler_mortality, data=excolonies2)
summary(mortalexpro)
```
```{r appexcolonies2 effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]

first_stage2<-mortalexpro
Expropriation_Protection<-mortalexpro$fitted.values
second_stage2<-lm(gdppc~Expropriation_Protection,data=excolonies2)
summary(second_stage2)

```
```{r mortalgdp excolonies2 graph}
ggplot(data=excolonies2)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+
  geom_abline(intercept = 10.344, 
              slope=-0.501, color="red")

```
```{r mortalexpro excolonies2 graph}
mortalgdp<-lm(expro_pro~settler_mortality,data=excolonies2)
summary(mortalgdp)
ggplot(data=excolonies2)+
  geom_point(mapping=aes(x=settler_mortality,
                         y=expro_pro,colour=counttrycol))+
  geom_abline(intercept = 8.184, 
              slope=-0.391, color="red")

```
### Excolonies contains all colonies including first world countries
```{r Appmortal gdp expro for all excolonies}
mortalgdp<- lm(gdppc~settler_mortality, data=excolonies)
summary(mortalgdp)
mortalexpro<-lm(expro_pro~settler_mortality, data=excolonies)
summary(mortalexpro)
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]


```
```{r App2 stages effect of expropriation on GDP}
first_stage <- lm(expro_pro~settler_mortality, data=excolonies)
Expropriation_Protection <- first_stage$fitted.values
second_stage <- lm(gdppc~Expropriation_Protection, data=excolonies)
summary(first_stage)
summary(second_stage)

```

### Excolnocon are the colonies from latin america and the caribbean
```{r mortal gdp excolnocon la/carib colonies}
# relation b/w settler mortality,gdp and expropriation for latin american and caribbean countries

mortalgdpnocon <- lm(gdppc~settler_mortality, data=excolnocon)
mortalexpronocon <- lm(expro_pro~settler_mortality, data=excolnocon)
summary(mortalgdpnocon)
summary(mortalexpronocon)

coef(mortalgdpnocon)["settler_mortality"]/coef(mortalexpronocon)["settler_mortality"]


first_stage1<-mortalexpronocon
Expropriation_Protection<-mortalexpronocon$fitted.values
second_stage1<-lm(gdppc~Expropriation_Protection,data=excolnocon)
summary(second_stage1)

```
```{r LA and Carib colonies }
ggplot(data=excolnocon)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+facet_wrap(~counttrycol)+ylim(4,10)+
  geom_abline(intercept = 10.55, slope=-0.4687, color="red")

```

```{r AppOLS regression of colonies}
#excolonies
exprogdp<-lm(gdppc~expro_pro, data=excolonies)
summary(exprogdp)
#excolonies2
exprogdp2<-lm(gdppc~expro_pro, data=excolonies2)
summary(exprogdp2)
#non_african
exprogdpnonaf<-lm(gdppc~expro_pro, data=non_african)
summary(exprogdpnonaf)
```

```{r Appsummary stats table}
Exclusive_table<-huxreg("Neu"=second_stage8,"Africa"=second_stage3,  "Asia"=second_stage5,"Latin/Carib"= second_stage1)

inclusive_first_stage<-huxreg("Excolonies"=first_stage, "Non Neu"=first_stage1, "Non_African"=first_stage4)

Inclusive_table<-huxreg("Excolonies"=second_stage,"Non Neu"=second_stage2,"Non_African"=second_stage4)
#,"Non-Asia"=second_stage6, "Non_Latin/Carib"=second_stage7

inclusive_ols<-huxreg("Excolonies"=exprogdp, "Non Neu"=exprogdp2, "Non_African"=exprogdpnonaf)

#Exclusive_table
#Inclusive_table
#inclusive_first_stage
#inclusive_ols
binded<-rbind(Inclusive_table,inclusive_first_stage,inclusive_ols)
binded


```

