---
title: "Divides in Development: An Analysis on the Impact of Colonialism on Today's Economies"
author: "Faria Khandaker"
date: "04/12/2020"
output:
  html_document:
    
    df_print: paged
  pdf_document:
    latex_engine: lualatex
font: 12pt
abstract: "What was done, what was found and why it matters?"
---
# Introduction



# Discussion and Analysis

```{r mortalgdp excolonies graph, echo=FALSE}
ggplot(data=excolonies)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+
  geom_abline(intercept = 10.731, 
              slope=-0.607, color="red")

```
```{r mortalexpro excolonies graph, echo=FALSE}
mortalgdp<-lm(expro_pro~settler_mortality,data=excolonies2)
summary(mortalgdp)
ggplot(data=excolonies)+
  geom_point(mapping=aes(x=settler_mortality,
                         y=expro_pro,colour=counttrycol))+
  geom_abline(intercept = 9.341, 
              slope=-0.391, color="red")

```
```{r expro vs gdp, echo=FALSE}



```

### short comings and limitations




# Ethics




# Conclusion


# References

### libraries used
```{r, echo=FALSE}
citation("tidyverse")
```
  H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
  Springer-Verlag New York, 2016.
  
  Wickham et al., (2019). Welcome to the tidyverse. Journal of
  Open Source Software, 4(43), 1686,
  https://doi.org/10.21105/joss.01686



### Datasets used can be found here
http://economics.mit.edu/faculty/acemoglu/data/ajr2001

### Research sources




# Appendix


```{r}
library(tidyverse)
library(dplyr)
library(janitor)
library(ggplot2)
library(haven)
library(huxtable)
```

```{r}
data4 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable4.dta")
data5 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable5.dta")
data6 <- read_dta("C:/Users/faria/Desktop/INF2178/Problem Sets/problemset5/maketable6.dta")
```

```{r select only 63 countries that are excolonies}

excolonies <- tibble(country=data4$shortnam,
                     samples=data4$baseco,
                     dummy_africa=data4$africa,
                     dummy_asia=data4$asia,
                     dummy_neu=data4$rich4,
                     britcol=data5$f_brit,
                     frencol=data5$f_french,
                     landlocked=data6$landlock,
                     settler_mortality=data4$logem4,
                     expro_pro=data4$avexpr, 
                     gdppc=data4$logpgp95
          
                     )%>% subset(samples==1)



excolonies<-excolonies %>% mutate(counttrycol= case_when(
                                  britcol==1~"British",
                                  frencol==1~"French",
                                  britcol==0~"Other",
                                  frencol==0~"Other"))


#latin american / caribbean countries

excolonies<-
  excolonies %>%
  mutate(nonasaf= dummy_africa+dummy_asia+dummy_neu,
         nonasaf=if_else(nonasaf==0,1,0))

#only latin american and caribbean
excolnocon <- excolonies %>% subset(dummy_africa==0)%>%
  subset(dummy_asia==0)%>%
  subset(dummy_neu==0)

#excolonies is master table with everything

#excolonies2 master table without dummy_neu, to take away outliers
excolonies2<-excolonies[!(excolonies$dummy_neu==1),]


#only africa
african<-
excolonies %>%
  filter(dummy_africa == "1")

# all colonies without africa
non_african <-
excolonies %>%
  filter(dummy_africa == "0")

#only asia
asian<-excolonies %>%
  filter(dummy_asia == "1")
#all colonies without asia

non_asian<-excolonies %>%
  filter(dummy_asia == "0")
#all colonies without latin america/caribbean
nonlacar<- excolonies%>%
  filter(nonasaf=="0")

#only neo-europe
neu <- excolonies %>%
  filter(dummy_neu == "1")


```

```{r lm mortalgdp only africa}
mortalgdp <- lm(gdppc~settler_mortality, data=african)
summary(mortalgdp)
```
```{r lm mortalexpro only africa}

mortalexpro <- lm(expro_pro~settler_mortality, data=african)
summary(mortalexpro)
```

```{r only africa effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
#your gdp will increase by 2 points if you have strong expropriation laws

first_stage3<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage3<-lm(gdppc~smortal_hat,data=african)
summary(second_stage3)
```
```{r lm mortalgdp non_african}
mortalgdp <- lm(gdppc~settler_mortality, data=non_african)
summary(mortalgdp)
```
```{r lm mortalexpro non_african}

mortalexpro <- lm(expro_pro~settler_mortality, data=non_african)
summary(mortalexpro)

```
```{r non_african effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage4<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage4<-lm(gdppc~smortal_hat,data=non_african)
summary(second_stage4)

```

```{r lm mortalgdp asian}
mortalgdp <- lm(gdppc~settler_mortality, data=asian)
summary(mortalgdp)
```
```{r lm mortalexpro asian}

mortalexpro <- lm(expro_pro~settler_mortality, data=asian)
summary(mortalexpro)

```
```{r asian effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage5<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage5<-lm(gdppc~smortal_hat,data=asian)
summary(second_stage5)

```

```{r lm mortalgdp non_asian}
mortalgdp <- lm(gdppc~settler_mortality, data=non_asian)
summary(mortalgdp)
```
```{r lm mortalexpro non_asian}

mortalexpro <- lm(expro_pro~settler_mortality, data=non_asian)
summary(mortalexpro)

```
```{r non_asian effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage6<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage6<-lm(gdppc~smortal_hat,data=non_asian)
summary(second_stage6)

```



```{r lm mortalgdp nonlacar}
mortalgdp <- lm(gdppc~settler_mortality, data=nonlacar)
summary(mortalgdp)
```
```{r lm mortalexpro nonlacar}

mortalexpro <- lm(expro_pro~settler_mortality, data=nonlacar)
summary(mortalexpro)

```
```{r nonlacar effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage7<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage7<-lm(gdppc~smortal_hat,data=nonlacar)
summary(second_stage7)

```

```{r lm mortalgdp neu}
mortalgdp <- lm(gdppc~settler_mortality, data=neu)
summary(mortalgdp)
```
```{r lm mortalexpro neu}

mortalexpro <- lm(expro_pro~settler_mortality, data=neu)
summary(mortalexpro)

```
```{r neu effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]
first_stage8<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage8<-lm(gdppc~smortal_hat,data=neu)
summary(second_stage8)

```


```{r histogram for gdp and expropriation non neu}
ggplot(data=excolonies2,mapping=aes(x=expro_pro, fill=counttrycol))+
  geom_histogram(position="dodge",binwidth=0.4)+theme_minimal()+scale_fill_brewer(palette = "Set1")
#facet_wrap(vars(dummy_asia), nrow=2)

```
### Excolonies2 is includes all excolonies except the neo european first world countries
```{r lm mortalgdp excolonies2}
mortalgdp <- lm(gdppc~settler_mortality, data=excolonies2)
summary(mortalgdp)

mortalexpro <- lm(expro_pro~settler_mortality, data=excolonies2)
summary(mortalexpro)
```
```{r excolonies2 effect of expropriation on gdp }
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]

first_stage2<-mortalexpro
smortal_hat<-mortalexpro$fitted.values
second_stage2<-lm(gdppc~smortal_hat,data=excolonies2)
summary(second_stage2)

```
```{r mortalgdp excolonies2 graph}
ggplot(data=excolonies2)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+
  geom_abline(intercept = 10.344, 
              slope=-0.501, color="red")

```
```{r mortalexpro excolonies2 graph}
mortalgdp<-lm(expro_pro~settler_mortality,data=excolonies2)
summary(mortalgdp)
ggplot(data=excolonies2)+
  geom_point(mapping=aes(x=settler_mortality,
                         y=expro_pro,colour=counttrycol))+
  geom_abline(intercept = 8.184, 
              slope=-0.391, color="red")

```
### Excolonies contains all colonies including first world countries
```{r mortal gdp expro for all excolonies}
mortalgdp<- lm(gdppc~settler_mortality, data=excolonies)
summary(mortalgdp)
mortalexpro<-lm(expro_pro~settler_mortality, data=excolonies)
summary(mortalexpro)
coef(mortalgdp)["settler_mortality"]/ coef(mortalexpro)["settler_mortality"]


```
```{r 2 stages effect of expropriation on GDP}
first_stage <- lm(expro_pro~settler_mortality, data=excolonies)
smortal_hat <- first_stage$fitted.values
second_stage <- lm(gdppc~smortal_hat, data=excolonies)
summary(first_stage)
summary(second_stage)

```

### Excolnocon are the colonies from latin america and the caribbean
```{r mortal gdp excolnocon la/carib colonies}
# relation b/w settler mortality,gdp and expropriation for latin american and caribbean countries

mortalgdpnocon <- lm(gdppc~settler_mortality, data=excolnocon)
mortalexpronocon <- lm(expro_pro~settler_mortality, data=excolnocon)
summary(mortalgdpnocon)
summary(mortalexpronocon)

coef(mortalgdpnocon)["settler_mortality"]/coef(mortalexpronocon)["settler_mortality"]


first_stage1<-mortalexpronocon
smortal_hat<-mortalexpronocon$fitted.values
second_stage1<-lm(gdppc~smortal_hat,data=excolnocon)
summary(second_stage1)

```
```{r LA and Carib colonies }
ggplot(data=excolnocon)+
  geom_point(mapping=aes(x=settler_mortality, 
                         y=gdppc, color=counttrycol))+facet_wrap(~counttrycol)+ylim(4,10)+
  geom_abline(intercept = 10.55, slope=-0.4687, color="red")

```

```{r summary stats table}
Exclusive_table<-huxreg("Neu"=second_stage8,"Africa"=second_stage3,  "Asia"=second_stage5,"Latin/Carib"= second_stage1)

Inclusive_table<-huxreg("Excolonies"=second_stage,"Non Neu"=second_stage2,"Non_Africa"=second_stage4,"Non-Asia"=second_stage6, "Non_Latin/Carib"=second_stage7)

Exclusive_table
Inclusive_table
```